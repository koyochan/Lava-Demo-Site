---
/* eslint max-lines: 'off' */
import { asset } from '../lib/data';
---

<!-- ページ全体のコンテナ -->
<div class="px-4 pt-6">
	<!-- グリッドレイアウト: 上段はメインチャート -->
	<div class="grid gap-4 xl:grid-cols-2 2xl:grid-cols-3">
		<!-- ▼▼ メインチャート (main-chart) ▼▼ -->
		<div
			class="p-4 bg-white border border-gray-200 rounded-lg shadow-sm 2xl:col-span-2 dark:border-gray-700 sm:p-6 dark:bg-gray-800"
		>
			<div class="flex items-center justify-between mb-4">
				<div class="flex-shrink-0">
					<!-- 今週の入店者数（合計） -->
					<span
						class="text-xl font-bold leading-none text-gray-900 sm:text-2xl dark:text-white"
					>
						975名
					</span>
					<h3 class="text-base font-light text-gray-500 dark:text-gray-400">
						今週の来店者数
					</h3>
				</div>
				<!-- 増減率などの表示 -->
				<div
					class="flex items-center justify-end flex-1 text-base font-medium text-green-500 dark:text-green-400"
				>
					+9.7%
					<svg
						class="w-5 h-5"
						fill="currentColor"
						viewBox="0 0 20 20"
						xmlns="http://www.w3.org/2000/svg"
					>
						<path
							fill-rule="evenodd"
							d="M5.293 7.707a1 1 0 010-1.414l4-4a1 1 0 011.414 
              0l4 4a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 
              0V5.414L6.707 7.707a1 1 0 01-1.414 0z"
							clip-rule="evenodd"></path>
					</svg>
				</div>
			</div>

			<!-- メインチャート描画先 -->
			<div id="main-chart"></div>

			<!-- フッター部分（期間ドロップダウンなど） -->
			<div
				class="flex items-center justify-between pt-3 mt-4 border-t border-gray-200 sm:pt-6 dark:border-gray-700"
			>
				<div>
					<button
						class="inline-flex items-center p-2 text-sm font-medium text-center text-gray-500 rounded-lg hover:text-gray-900 dark:text-gray-400 dark:hover:text-white"
						type="button"
						data-dropdown-toggle="weekly-visitors-dropdown"
					>
						直近7日間
						<svg
							class="w-4 h-4 ml-2"
							fill="none"
							stroke="currentColor"
							viewBox="0 0 24 24"
							xmlns="http://www.w3.org/2000/svg"
						>
							<path
								stroke-linecap="round"
								stroke-linejoin="round"
								stroke-width="2"
								d="M19 9l-7 7-7-7"></path>
						</svg>
					</button>
					<!-- ドロップダウンメニュー -->
					<!-- （省略） -->
				</div>
				<div class="flex-shrink-0">
					<a
						href="#"
						class="inline-flex items-center p-2 text-xs font-medium uppercase rounded-lg text-primary-700 sm:text-sm hover:bg-gray-100 dark:text-primary-500 dark:hover:bg-gray-700"
					>
						入店者レポート
						<svg
							class="w-4 h-4 ml-1"
							fill="none"
							stroke="currentColor"
							viewBox="0 0 24 24"
							xmlns="http://www.w3.org/2000/svg"
						>
							<path
								stroke-linecap="round"
								stroke-linejoin="round"
								stroke-width="2"
								d="M9 5l7 7-7 7"></path>
						</svg>
					</a>
				</div>
			</div>
		</div>

		<!-- ▼▼ 推定属性チャート (attribute-chart) ▼▼ -->
		<div
			class="p-4 bg-white border border-gray-200 rounded-lg shadow-sm dark:border-gray-700 sm:p-6 dark:bg-gray-800"
		>
			<!-- タイトル -->
			<h3 class="mb-4 text-lg font-semibold text-gray-900 dark:text-white">
				今週の来店者属性
			</h3>
			<!-- 描画先 -->
			<div id="attribute-chart" class="h-72"></div>
		</div>
	</div>
</div>

<!-- 2行目: 性別比率, 年齢分布 -->
<div class="grid w-full grid-cols-1 gap-4 mt-4 xl:grid-cols-2 2xl:grid-cols-2">
	<!-- ▼▼ 性別比率チャート (gender-chart) ▼▼ -->
	<div
		class="p-4 bg-white border border-gray-200 rounded-lg shadow-sm dark:border-gray-700 sm:p-6 dark:bg-gray-800"
	>
		<h3 class="mb-4 text-lg font-semibold text-gray-900 dark:text-white">
			今週の性別比率
		</h3>
		<div id="gender-chart" class="h-72"></div>
	</div>

	<!-- ▼▼ 年齢分布チャート (age-chart) ▼▼ -->
	<div
		class="p-4 bg-white border border-gray-200 rounded-lg shadow-sm dark:border-gray-700 sm:p-6 dark:bg-gray-800"
	>
		<h3 class="mb-4 text-lg font-semibold text-gray-900 dark:text-white">
			年齢分布
		</h3>
		<div id="age-chart" class="h-72"></div>
	</div>
</div>

<!-- 3行目: 時間帯別混雑率 (time-chart) -->
<div class="grid w-full grid-cols-1 gap-4 mt-4 xl:grid-cols-1 2xl:grid-cols-1">
	<div
		class="p-4 bg-white border border-gray-200 rounded-lg shadow-sm dark:border-gray-700 sm:p-6 dark:bg-gray-800"
	>
		<h3 class="mb-4 text-lg font-semibold text-gray-900 dark:text-white">
			時間帯別混雑率
		</h3>
		<!-- 1日の時間帯ごとを棒グラフで可視化 -->
		<div id="time-chart" class="h-72"></div>
	</div>
</div>

<!-- ▼▼ Carousel（AIインサイト）: 省略（上記と同様） ▼▼ -->
<div class="grid grid-cols-1 my-4 xl:gap-4">
	<div
		class="p-4 bg-white border border-gray-200 rounded-lg shadow-sm dark:border-gray-700 sm:p-6 dark:bg-gray-800"
	>
		<div id="carousel" class="relative" data-carousel="">
			<!-- スライド領域の高さを設定 -->
			<div class="relative mx-auto overflow-hidden h-[36rem] lg:h-[24rem]">
				<!-- ▼▼ スライド1: この店舗の最新トレンド ▼▼ -->
				<div
					class="hidden duration-700 ease-in-out bg-white dark:bg-gray-800"
					data-carousel-item
				>
					<div
						class="flex items-center mb-4 text-lg font-medium text-primary-600"
					>
						<svg
							class="w-6 h-6 mr-2"
							fill="currentColor"
							viewBox="0 0 20 20"
							xmlns="http://www.w3.org/2000/svg"
							aria-hidden="true"
						>
							<path
								clip-rule="evenodd"
								fill-rule="evenodd"
								d="M9.664 1.319a.75.75 0 01.672 0 
                   41.059 41.059 0 018.198 5.424.75.75 0 01-.254 1.285 
                   31.372 31.372 0 00-7.86 3.83.75.75 0 01-.84 0 
                   31.508 31.508 0 00-2.08-1.287V9.394c0-.244.116-.463.302-.592
                   a35.504 35.504 0 013.305-2.033.75.75 0 00-.714-1.319 
                   37 37 0 00-3.446 2.12A2.216 2.216 0 006 9.393v.38
                   a31.293 31.293 0 00-4.28-1.746.75.75 0 01-.254-1.285 
                   41.059 41.059 0 018.198-5.424zM6 11.459a29.848 29.848 
                   0 00-2.455-1.158 41.029 41.029 0 00-.39 3.114.75.75 
                   0 00.419.74c.528.256 1.046.53 1.554.82-.21.324-.455.63-.739.914
                   a.75.75 0 101.06 1.06c.37-.369.69-.77.96-1.193a26.61 26.61 
                   0 013.095 2.348.75.75 0 00.992 0 26.547 26.547 0 
                   015.93-3.95.75.75 0 00.42-.739 41.053 41.053 0 
                   00-.39-3.114 29.925 29.925 0 00-5.199 2.801 2.25 
                   2.25 0 01-2.514 0c-.41-.275-.826-.541-1.25-.797a6.985 
                   6.985 0 01-1.084 3.45 26.503 26.503 0 00-1.281-.78A5.487 
                   5.487 0 006 12v-.54z"
							></path>
						</svg>
						インサイト
					</div>

					<h3 class="mb-4 text-2xl font-medium text-gray-900 dark:text-white">
						○○店の最新トレンド
					</h3>

					<p class="mb-4 text-gray-500 dark:text-gray-400">
						直近1ヶ月で当店の会員登録数が10%増加し、特に夕方(18〜20時)は
						混雑率が上昇傾向にあります。土曜朝のクラスも60%を超える予約率を記録しています。
					</p>

					<p class="mb-2 text-lg font-medium text-gray-900 dark:text-white">
						ハイライト:
					</p>
					<ul
						class="pl-4 mb-4 space-y-3 text-gray-500 list-disc dark:text-gray-400"
					>
						<li>
							平日夕方の予約率: <b class="text-green-600">70%</b> (先月比+8%)
						</li>
						<li>
							20〜30代女性の利用者が全体の<b class="text-green-600">60%</b>に
						</li>
						<li>
							土曜朝(9〜11時)のクラスが<b class="text-green-600">60%</b
							>超の予約率
						</li>
						<li>夜間(21時以降)は利用率が低く改善可能</li>
					</ul>

					<a
						href="#"
						class="inline-flex items-center p-2 font-medium rounded-lg text-primary-700 hover:bg-gray-100 dark:text-primary-500 dark:hover:bg-gray-700"
					>
						詳しく見る
						<svg
							class="w-5 h-5 ml-1"
							fill="currentColor"
							viewBox="0 0 20 20"
							xmlns="http://www.w3.org/2000/svg"
							aria-hidden="true"
						>
							<path
								clip-rule="evenodd"
								fill-rule="evenodd"
								d="M2 10a.75.75 0 01.75-.75h12.59l-2.1-1.95a.75.75 
                   0 111.02-1.1l3.5 3.25a.75.75 0 010 1.1l-3.5 3.25
                   a.75.75 0 11-1.02-1.1l2.1-1.95H2.75A.75.75 
                   0 012 10z"
							></path>
						</svg>
					</a>
				</div>

				<!-- ▼▼ スライド2: AI提案 - 店舗スタッフができる新クラス・サービス ▼▼ -->
				<div
					class="hidden duration-700 ease-in-out bg-white dark:bg-gray-800"
					data-carousel-item
				>
					<div class="flex items-center mb-4 text-lg font-medium text-teal-500">
						<svg
							class="w-6 h-6 mr-2"
							fill="currentColor"
							viewBox="0 0 20 20"
							xmlns="http://www.w3.org/2000/svg"
							aria-hidden="true"
						>
							<path
								clip-rule="evenodd"
								fill-rule="evenodd"
								d="M5.752 12A13.07 13.07 
                   0 008 14.248v4.002c0 .414.336.75.75.75a5 5 0 004.797-6.414 
                   12.984 12.984 0 005.45-10.848.75.75 0 00-.735-.735 
                   12.984 12.984 0 00-10.849 5.45A5 5 0 001 
                   11.25c.001.414.337.75.751.75h4.002zM13 9a2 2 0 100-4 
                   2 2 0 000 4z"
							></path>
						</svg>
						AI提案: 店舗スタッフ対応の新クラス・サービス
					</div>

					<p class="mb-4 text-gray-500 dark:text-gray-400">
						AI予測によると、短時間レッスンや早朝クラスの需要が引き続き増加見込みです。
						店舗スタッフが主導で導入できる小規模な施策から始めると効果的です。
					</p>

					<p class="mb-4 text-lg font-medium text-gray-900 dark:text-white">
						検討案:
					</p>
					<ul
						role="list"
						class="pl-2 mb-4 space-y-3 text-gray-500 list-disc dark:text-gray-400"
					>
						<li>
							<b class="text-gray-800 dark:text-gray-200">朝ヨガ30分コース:</b>
							平日早朝の短縮レッスンを1コマ追加（スタッフ調整で実施可能）
						</li>
						<li>
							<b class="text-gray-800 dark:text-gray-200">夕方時短プログラム:</b
							>
							18時台に1回30分のクイックレッスンを開設し、混雑を分散
						</li>
						<li>
							<b class="text-gray-800 dark:text-gray-200">店頭予約サポート:</b>
							スタッフが空きクラス案内・クロスセルを行う (アプリ不要)
						</li>
					</ul>

					<a
						href="#"
						class="inline-flex items-center p-2 font-medium rounded-lg text-primary-700 hover:bg-gray-100 dark:text-primary-500 dark:hover:bg-gray-700"
					>
						詳しく見る
						<svg
							class="w-5 h-5 ml-1"
							fill="currentColor"
							viewBox="0 0 20 20"
							xmlns="http://www.w3.org/2000/svg"
							aria-hidden="true"
						>
							<path
								clip-rule="evenodd"
								fill-rule="evenodd"
								d="M2 10a.75.75 0 01.75-.75h12.59l-2.1-1.95a.75.75 
                   0 111.02-1.1l3.5 3.25a.75.75 0 010 1.1l-3.5 3.25
                   a.75.75 0 11-1.02-1.1l2.1-1.95H2.75A.75.75 
                   0 012 10z"
							></path>
						</svg>
					</a>
				</div>

				<!-- ▼▼ スライド3: AI提案 - シフト・キャンペーン（店舗レベルで可能） ▼▼ -->
				<div
					class="hidden duration-700 ease-in-out bg-white dark:bg-gray-800"
					data-carousel-item
				>
					<div
						class="flex items-center mb-4 text-lg font-medium text-indigo-500"
					>
						<svg
							class="w-6 h-6 mr-2"
							fill="currentColor"
							viewBox="0 0 20 20"
							xmlns="http://www.w3.org/2000/svg"
							aria-hidden="true"
						>
							<path
								fill-rule="evenodd"
								d="M2 10a8 8 0 1116 0 8 8 0 
                   01-16 0zm8-5a5 5 0 100 10 5 5 0 000-10z"
								clip-rule="evenodd"></path>
						</svg>
						AI提案: シフト & キャンペーン
					</div>

					<p class="mb-2 text-gray-500 dark:text-gray-400">
						当店の来店データをもとに、スタッフ配置と店頭キャンペーンを最適化する
						案がAIから提示されています。店舗レベルで対応しやすい項目だけを抜粋しました。
					</p>

					<h3 class="mb-2 text-lg font-medium text-gray-900 dark:text-white">
						具体的な施策:
					</h3>
					<ul
						role="list"
						class="pl-5 mb-4 space-y-2 text-gray-500 list-disc dark:text-gray-400"
					>
						<li>
							<b class="text-gray-800 dark:text-gray-200">ピーク対策:</b>
							平日18〜20時に2名のインストラクターを確保＋受付のサポート要員配置
						</li>
						<li>
							<b class="text-gray-800 dark:text-gray-200">学生向け割引:</b>
							土日14時台に学生が多いため、店頭で学割プランを追加提案
						</li>
						<li>
							<b class="text-gray-800 dark:text-gray-200">夜間帯のテコ入れ:</b>
							21時以降に来店した人向けに「ナイトプラン」の割引券を配布
						</li>
					</ul>

					<p class="mb-4 text-gray-500 dark:text-gray-400">
						キャンペーン告知やスタッフ配置は店舗判断で実行可能です。
						定期的に来店データをチェックし、適宜ブラッシュアップしましょう。
					</p>

					<a
						href="#"
						class="inline-flex items-center p-2 font-medium rounded-lg text-primary-700 hover:bg-gray-100 dark:text-primary-500 dark:hover:bg-gray-700"
					>
						詳しく見る
						<svg
							class="w-5 h-5 ml-1"
							fill="currentColor"
							viewBox="0 0 20 20"
							xmlns="http://www.w3.org/2000/svg"
							aria-hidden="true"
						>
							<path
								clip-rule="evenodd"
								fill-rule="evenodd"
								d="M2 10a.75.75 0 01.75-.75h12.59l-2.1-1.95a.75.75 
                   0 111.02-1.1l3.5 3.25a.75.75 0 010 1.1l-3.5 3.25
                   a.75.75 0 11-1.02-1.1l2.1-1.95H2.75A.75.75 
                   0 012 10z"
							></path>
						</svg>
					</a>
				</div>

				<!-- ▼▼ スライド4: 新規入会促進 & 部分的イベント案 ▼▼ -->
				<div
					class="hidden duration-700 ease-in-out bg-white dark:bg-gray-800"
					data-carousel-item
				>
					<div
						class="flex items-center mb-4 text-lg font-medium text-purple-500"
					>
						<svg
							class="w-6 h-6 mr-2"
							fill="currentColor"
							viewBox="0 0 20 20"
							xmlns="http://www.w3.org/2000/svg"
							aria-hidden="true"
						>
							<path
								fill-rule="evenodd"
								d="M2 10a8 8 0 1116 0 8 8 0 
                   01-16 0zm8-5a5 5 0 100 10 
                   5 5 0 000-10z"
								clip-rule="evenodd"></path>
						</svg>
						AI提案: 新規入会促進 & イベント
					</div>

					<p class="mb-2 text-gray-500 dark:text-gray-400">
						当店のデータでは、平日昼間や土曜午後に初回体験が集中する傾向あり。
						店舗内イベントや回数券キャンペーンなど、**現場で実施可能な施策**を提案します。
					</p>

					<h3 class="mb-2 text-lg font-medium text-gray-900 dark:text-white">
						具体案:
					</h3>
					<ul
						role="list"
						class="pl-5 mb-4 space-y-2 text-gray-500 list-disc dark:text-gray-400"
					>
						<li>
							<b class="text-gray-800 dark:text-gray-200">トライアル強化:</b>
							平日昼間の初回体験枠を増やし、店頭で次回予約も促進
						</li>
						<li>
							<b class="text-gray-800 dark:text-gray-200">回数券の店頭割引:</b>
							登録日当日のみ有効な割引クーポンを手渡し→リピート率UP
						</li>
						<li>
							<b class="text-gray-800 dark:text-gray-200">ミニイベント開催:</b>
							店舗スペースで「ヨガグッズ試用会」「健康相談会」など週末に実施
						</li>
					</ul>

					<p class="mb-4 text-gray-500 dark:text-gray-400">
						大掛かりなシステム連携なしでも、店頭スタッフのアイデア次第で
						新規入会のハードルを下げ、既存会員の満足度も高められます。
					</p>

					<a
						href="#"
						class="inline-flex items-center p-2 font-medium rounded-lg text-primary-700 hover:bg-gray-100 dark:text-primary-500 dark:hover:bg-gray-700"
					>
						詳しく見る
						<svg
							class="w-5 h-5 ml-1"
							fill="currentColor"
							viewBox="0 0 20 20"
							xmlns="http://www.w3.org/2000/svg"
							aria-hidden="true"
						>
							<path
								clip-rule="evenodd"
								fill-rule="evenodd"
								d="M2 10a.75.75 0 01.75-.75h12.59l-2.1-1.95a.75.75 
                   0 111.02-1.1l3.5 3.25a.75.75 0 010 1.1l-3.5 3.25
                   a.75.75 0 11-1.02-1.1l2.1-1.95H2.75A.75.75 
                   0 012 10z"
							></path>
						</svg>
					</a>
				</div>
			</div>

			<!-- ▼▼ Carousel ナビゲーションボタン ▼▼ -->
			<div class="flex items-center justify-center">
				<!-- 前へ -->
				<button
					type="button"
					class="flex items-center justify-center h-full mr-4 cursor-pointer group focus:outline-none"
					data-carousel-prev
				>
					<span
						class="text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200"
					>
						<svg
							class="w-6 h-6"
							fill="currentColor"
							viewBox="0 0 20 20"
							xmlns="http://www.w3.org/2000/svg"
						>
							<path
								fill-rule="evenodd"
								d="M7.707 14.707a1 1 0 01-1.414 
                   0l-4-4a1 1 0 010-1.414l4-4a1 1 0 
                   011.414 1.414L5.414 9H17a1 1 
                   0 110 2H5.414l2.293 2.293a1 1 
                   0 010 1.414z"
								clip-rule="evenodd"></path>
						</svg>
						<span class="hidden">Previous</span>
					</span>
				</button>

				<!-- 次へ -->
				<button
					type="button"
					class="flex items-center justify-center h-full cursor-pointer group focus:outline-none"
					data-carousel-next
				>
					<span
						class="text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200"
					>
						<svg
							class="w-6 h-6"
							fill="currentColor"
							viewBox="0 0 20 20"
							xmlns="http://www.w3.org/2000/svg"
						>
							<path
								fill-rule="evenodd"
								d="M12.293 5.293a1 1 
                   0 011.414 0l4 4a1 1 
                   0 010 1.414l-4 4a1 1 
                   0 01-1.414-1.414L14.586 11H3a1 1 0 
                   110-2h11.586l-2.293-2.293a1 1 
                   0 010-1.414z"
								clip-rule="evenodd"></path>
						</svg>
						<span class="hidden">Next</span>
					</span>
				</button>
			</div>
		</div>
	</div>
</div>

<script>
	import './DashBoard.client.js';
</script>

<style is:global>
	/* chart styles */
	.apexcharts-tooltip {
		@apply bg-white dark:bg-gray-700 text-gray-500 dark:text-gray-400 border-0 rounded-lg shadow-lg !important;
	}

	.apexcharts-tooltip .apexcharts-tooltip-title {
		@apply py-2 px-4 bg-gray-100 dark:bg-gray-600 border-b border-gray-200 dark:border-gray-500 !important;
	}

	.apexcharts-xaxistooltip {
		@apply text-gray-500 border-0 bg-white dark:bg-gray-700 dark:text-gray-300 rounded-lg shadow-lg !important;
	}

	.apexcharts-tooltip .apexcharts-tooltip-text-y-value {
		@apply dark:text-white;
	}

	.apexcharts-xaxistooltip-text {
		@apply font-medium text-sm !important;
	}

	.apexcharts-xaxistooltip:before,
	.apexcharts-xaxistooltip:after {
		@apply border-0 !important;
	}
</style>
